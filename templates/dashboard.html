<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - TaskFlow</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* Modern CSS Variables for Consistent Design */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --dark-glass: rgba(0, 0, 0, 0.1);
            
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.15);
            
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --border-radius-lg: 24px;
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s ease;
            
            --sidebar-width: 280px;
            --sidebar-collapsed-width: 80px;
        }

        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body.dashboard-bg {
            min-height: 100vh;
            background: var(--primary-gradient);
            background-attachment: fixed;
            display: flex;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif, 'Poppins';
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Mobile Menu Button */
        .mobile-menu-btn {
            position: fixed;
            top: 1rem;
            left: 1rem;
            width: 50px;
            height: 50px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            z-index: 2001;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
        }

        .mobile-menu-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        /* Overlay for mobile */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Modern Sidebar Design */
        .sidebar {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            color: #fff;
            width: var(--sidebar-width);
            min-width: var(--sidebar-width);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            transition: var(--transition);
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .sidebar.collapsed {
            width: var(--sidebar-collapsed-width);
            min-width: var(--sidebar-collapsed-width);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            min-height: 80px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--success-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            box-shadow: var(--shadow-md);
            flex-shrink: 0;
            transition: var(--transition);
        }

        /* Menu icon replacement when collapsed */
        .sidebar.collapsed .logo-icon {
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }

        .sidebar.collapsed .logo-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .sidebar-title {
            font-size: 1.4rem;
            font-weight: 700;
            background: linear-gradient(45deg, #fff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
            transition: var(--transition);
            white-space: nowrap;
            overflow: hidden;
        }

        .sidebar.collapsed .sidebar-title {
            opacity: 0;
            width: 0;
        }

        .sidebar-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .sidebar-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        /* Hide toggle button when collapsed */
        .sidebar.collapsed .sidebar-toggle {
            opacity: 0;
            width: 0;
            padding: 0;
            margin: 0;
            border: none;
        }

        .sidebar-nav {
            list-style: none;
            padding: 1rem 0;
            flex: 1;
        }

        .sidebar-nav li {
            margin: 0.5rem 1rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            padding: 1rem;
            border-radius: var(--border-radius-sm);
            transition: var(--transition);
            font-weight: 500;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: var(--transition);
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            transform: translateX(4px);
        }


        .nav-link.logout:hover {
            background: rgba(247, 36, 36, 0.89);
            color: #fecaca;
        }

        .nav-icon {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .nav-text {
            white-space: nowrap;
            overflow: hidden;
            transition: var(--transition);
        }

        .sidebar.collapsed .nav-text {
            opacity: 0;
            width: 0;
        }

        .sidebar.collapsed .nav-link {
            justify-content: center;
            padding: 1rem 0.5rem;
        }

        /* Modern Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 2rem;
            width: calc(100% - var(--sidebar-width));
            min-height: 100vh;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.05);
        }

        .main-content.expanded {
            margin-left: var(--sidebar-collapsed-width);
            width: calc(100% - var(--sidebar-collapsed-width));
        }

        /* Dashboard Header */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
        }

        .welcome-section h1.welcome-title {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, #fff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -1px;
        }

        .welcome-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
            font-weight: 400;
        }

        .date-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .current-date {
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .current-time {
            color: rgba(255, 255, 255, 0.8);
            font-size: 2rem;
            font-weight: 300;
            font-family: 'SF Mono', 'Monaco', monospace;
        }

        /* Modern Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
            transition: var(--transition);
        }

        .stat-card.stat-primary::before { background: var(--primary-gradient); }
        .stat-card.stat-success::before { background: var(--success-gradient); }
        .stat-card.stat-warning::before { background: var(--warning-gradient); }
        .stat-card.stat-info::before { background: var(--secondary-gradient); }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
        }

        .stat-card.stat-primary .stat-icon { background: var(--primary-gradient); }
        .stat-card.stat-success .stat-icon { background: var(--success-gradient); }
        .stat-card.stat-warning .stat-icon { background: var(--warning-gradient); }
        .stat-card.stat-info .stat-icon { background: var(--secondary-gradient); }

        .stat-content {
            flex: 1;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: #fff;
            line-height: 1;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            color: #fff;
            margin: 0;
        }

        .section-actions {
            display: flex;
            gap: 1rem;
        }

        /* Task Filters */
        .task-filters {
            display: flex;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        /* Modern Task Form */
        .task-form-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
        }

        .form-header {
            margin-bottom: 1.5rem;
        }

        .form-header h3 {
            color: #fff;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .task-form {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 1rem;
            align-items: end;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-input {
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-sm);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
        }

        /* Priority container and label styles */
        .task-priority-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .priority-label {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .priority-label.priority-low {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: #ffffff;
            border-color: white;
            border: 2px solid;
        }

        .priority-label.priority-medium {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: #ffffff;
            border-color: white;
            border: 2px solid;
        }

        .priority-label.priority-high {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: #ffffff;
            border-color: white;
            border: 2px solid;
        }

        /* Modern Buttons */
        .btn-primary,
        .btn-secondary {
            padding: 1rem 2rem;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            justify-content: center;
        }

        .btn-primary {
            background: var(--success-gradient);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        /* Modern Task Cards */
        .tasks-container {
            position: relative;
        }

        .task-grid {
            display: grid;
            gap: 1rem;
            list-style: none;
        }

        .task-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: var(--transition);
            animation: slideInUp 0.5s ease forwards;
            opacity: 0;
            transform: translateY(20px);
            box-shadow: var(--shadow-md);
        }

        @keyframes slideInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .task-priority {
            width: 4px;
            height: 20px;
            border-radius: 2px;
        }

        .priority-low { background: var(--success-gradient); }
        .priority-medium { background: var(--warning-gradient); }
        .priority-high { background: var(--danger-gradient); }

        .task-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Bulk Actions Bar */
        .bulk-actions-bar {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-md);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .bulk-actions-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .bulk-actions-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .bulk-action-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .export-btn {
            background: var(--success-gradient);
            color: white;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .clear-btn {
            background: var(--danger-gradient);
            color: white;
        }

        .clear-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Task Selection Checkbox */
        .task-selection-checkbox {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            z-index: 10;
            width: 20px;
            height: 20px;
            accent-color: var(--primary-gradient);
        }

        .task-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.1);
        }

        .task-btn:hover {
            transform: scale(1.1);
        }

        .edit-btn:hover {
            background: rgba(59, 130, 246, 0.3);
            color: #60a5fa;
        }

        .delete-btn:hover {
            background: rgba(239, 68, 68, 0.3);
            color: #f87171;
        }

        .task-content {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        /* Simple and Reliable Checkbox Styling */
        .task-checkbox {
            position: relative;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .task-checkbox input[type="checkbox"] {
            opacity: 0;
            position: absolute;
            width: 24px;
            height: 24px;
            cursor: pointer;
            z-index: 2;
            margin: 0;
        }

        .checkbox-custom {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            position: relative;
            backdrop-filter: blur(10px);
            font-size: 14px;
            font-weight: bold;
            color: transparent;
        }

        .checkbox-custom:hover {
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.15);
            transform: scale(1.05);
        }

        .task-checkbox input[type="checkbox"]:checked + .checkbox-custom {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.4);
        }

        .task-checkbox input[type="checkbox"]:checked + .checkbox-custom::after {
            content: 'âœ“';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
            font-weight: 900;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            line-height: 1;
            animation: checkPop 0.2s ease-out;
        }

        @keyframes checkPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 0.8;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        /* Focus styles for accessibility */
        .task-checkbox input[type="checkbox"]:focus + .checkbox-custom {
            outline: 2px solid rgba(79, 172, 254, 0.5);
            outline-offset: 2px;
        }

        .task-details {
            flex: 1;
        }

        .task-title {
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            transition: var(--transition);
        }

        .task-title.completed {
            text-decoration: line-through;
            opacity: 0.6;
        }

        .task-meta {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .due-date {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .due-date.overdue {
            color: #f87171;
        }

        .overdue-badge {
            background: var(--danger-gradient);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-left: 0.5rem;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        /* Loading State */
        .loading-state {
            text-align: center;
            padding: 4rem 2rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .task-priority-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .priority-label {
                font-size: 0.7rem;
                padding: 0.2rem 0.5rem;
            }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .task-form {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        @media (max-width: 1024px) {
            :root {
                --sidebar-width: 260px;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .welcome-section h1.welcome-title {
                font-size: 2.2rem;
            }
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: flex;
            }

            .main-content {
                margin-left: 0;
                width: 100%;
                padding: 1rem;
                padding-top: 4rem;
            }
            
            .main-content.expanded {
                margin-left: 0;
                width: 100%;
            }
            
            .sidebar {
                transform: translateX(-100%);
                width: var(--sidebar-width);
                box-shadow: var(--shadow-xl);
            }
            
            .sidebar.collapsed {
                transform: translateX(-100%);
                width: var(--sidebar-width);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .welcome-section h1.welcome-title {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
        }

        /* Error and success states */
        .error-message {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid rgba(248, 113, 113, 0.3);
            color: #fecaca;
            padding: 1rem;
            border-radius: var(--border-radius-sm);
            margin: 1rem 0;
            display: none;
        }

        .success-message {
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid rgba(74, 222, 128, 0.3);
            color: #86efac;
            padding: 1rem;
            border-radius: var(--border-radius-sm);
            margin: 1rem 0;
            display: none;
        }

        /* Notification Bell */
        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            width: 50px;
            height: 50px;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            position: relative;
        }

        .header-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            transform: scale(1.05);
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--danger-gradient);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
            }
        }

        /* Due Soon Indicator */
        .due-soon-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--warning-gradient);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            z-index: 2500;
            cursor: pointer;
            transition: var(--transition);
            display: none;
        }

        .due-soon-indicator:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .due-soon-indicator.show {
            display: block;
            animation: slideInUp 0.5s ease-out;
        }

        /* Toast notification styles */
        .toast-notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1rem 1.5rem;
            color: #fff;
            box-shadow: var(--shadow-lg);
            z-index: 3000;
            transform: translateX(100%);
            opacity: 0;
            transition: var(--transition);
            max-width: 350px;
        }

        .toast-notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .toast-title {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .toast-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .toast-message {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85rem;
            line-height: 1.4;
        }
        /*Settings Styles*/
        /* Custom SweetAlert2 styling for modern settings */
        .modern-settings-popup {
            background: rgba(255, 255, 255, 0.1) !important;
            backdrop-filter: blur(20px) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 24px !important;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25) !important;
            color: #fff !important;
        }

        .modern-settings-popup .swal2-title {
            display: none !important;
        }

        .modern-settings-popup .swal2-html-container {
            margin: 0 !important;
            padding: 0 !important;
        }

        .modern-confirm-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%) !important;
            border: none !important;
            border-radius: 12px !important;
            padding: 12px 24px !important;
            font-weight: 600 !important;
            font-size: 14px !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3) !important;
        }

        .modern-confirm-btn:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4) !important;
        }

        .modern-cancel-btn {
            background: rgba(255, 255, 255, 0.1) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 12px !important;
            padding: 12px 24px !important;
            font-weight: 600 !important;
            font-size: 14px !important;
            color: rgba(255, 255, 255, 0.9) !important;
            transition: all 0.3s ease !important;
            margin-right: 10px !important;
        }

        .modern-cancel-btn:hover {
            background: rgba(255, 255, 255, 0.2) !important;
            transform: translateY(-2px) !important;
        }

        /* Modern Settings Container */
        .modern-settings-container {
            padding: 0;
            color: #fff;
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Scrollbar styling */
        .modern-settings-container::-webkit-scrollbar {
            width: 6px;
        }

        .modern-settings-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .modern-settings-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .modern-settings-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        /* Settings Header */
        .settings-header {
            text-align: center;
            padding: 2rem 2rem 1.5rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
        }

        .settings-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem auto;
            font-size: 2rem;
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .settings-title {
            font-size: 2rem;
            font-weight: 700;
            margin: 0 0 0.5rem 0;
            background: linear-gradient(45deg, #fff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .settings-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
            margin: 0;
        }

        /* Settings Content */
        .settings-content {
            padding: 0 2rem;
        }

        /* Settings Sections */
        .settings-section {
            margin-bottom: 2.5rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section-info h4 {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0 0 0.25rem 0;
            color: #fff;
        }

        .section-info p {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin: 0;
        }

        /* Settings Grid */
        .settings-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .setting-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .setting-details {
            flex: 1;
        }

        .setting-label {
            display: block;
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 0.25rem;
        }

        .setting-description {
            display: block;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Modern Toggle Switch */
        .modern-toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            cursor: pointer;
        }

        .modern-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            border-radius: 34px;
            backdrop-filter: blur(10px);
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 3px;
            bottom: 3px;
            background: linear-gradient(135deg, #fff 0%, #f1f5f9 100%);
            transition: all 0.3s ease;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .modern-toggle input:checked + .toggle-slider {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-color: rgba(79, 172, 254, 0.5);
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.3);
        }

        .modern-toggle input:checked + .toggle-slider:before {
            transform: translateX(26px);
            background: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        /* Theme Selector */
        .theme-selector {
            padding: 1rem;
        }

        .theme-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
        }

        .theme-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .theme-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: all 0.5s ease;
        }

        .theme-option:hover::before {
            left: 100%;
        }

        .theme-option:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .theme-option.active {
            border-color: rgba(79, 172, 254, 0.6);
            background: rgba(79, 172, 254, 0.1);
            box-shadow: 0 0 25px rgba(79, 172, 254, 0.2);
        }

        .theme-option input {
            display: none;
        }

        .theme-preview {
            width: 80px;
            height: 60px;
            border-radius: 12px;
            margin-bottom: 1rem;
            padding: 8px;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .theme-colors {
            display: flex;
            height: 100%;
            border-radius: 8px;
            overflow: hidden;
        }

        .theme-colors .color-1,
        .theme-colors .color-2,
        .theme-colors .color-3 {
            flex: 1;
            transition: all 0.3s ease;
        }

        /* Default Theme Colors */
        .default-theme .color-1 { background: #667eea; }
        .default-theme .color-2 { background: #764ba2; }
        .default-theme .color-3 { background: #f093fb; }

        /* Dark Theme Colors */
        .dark-theme .color-1 { background: #2d3748; }
        .dark-theme .color-2 { background: #1a202c; }
        .dark-theme .color-3 { background: #4a5568; }

        /* Light Theme Colors */
        .light-theme .color-1 { background: #f7fafc; }
        .light-theme .color-2 { background: #edf2f7; }
        .light-theme .color-3 { background: #e2e8f0; }

        .theme-name {
            font-size: 0.9rem;
            font-weight: 600;
            color: #fff;
            text-align: center;
        }

        /* Settings Footer */
        .settings-footer {
            padding: 1.5rem 2rem 2rem 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 1rem;
        }

        .footer-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            justify-content: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.85rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-info i {
            color: rgba(79, 172, 254, 0.8);
            font-size: 1rem;
        }

        /* Responsive Design for Settings */
        @media (max-width: 768px) {
            .modern-settings-popup {
                width: 95% !important;
                margin: 0 !important;
            }
            
            .settings-header {
                padding: 1.5rem 1rem 1rem 1rem;
            }
            
            .settings-title {
                font-size: 1.5rem;
            }
            
            .settings-content {
                padding: 0 1rem;
            }
            
            .theme-options {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .theme-option {
                padding: 1rem;
            }
            
            .theme-preview {
                width: 60px;
                height: 45px;
            }
            
            .section-header {
                flex-direction: column;
                text-align: center;
                gap: 0.75rem;
            }
            
            .setting-item {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .settings-footer {
                padding: 1rem;
            }
        }
        .urgency-badge {
            font-size: 0.7rem;
            font-weight: 700;
            padding: 0.25rem 0.5rem;
            border-radius: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 0.5rem;
            animation: pulse 2s infinite;
        }

        .overdue-urgent {
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);
        }

        .today-urgent {
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
        }

        .tomorrow-urgent {
            background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(14, 165, 233, 0.3);
        }

        .due-today {
            color: #f59e0b !important;
            font-weight: 600;
        }

        .today-badge {
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            color: white;
            padding: 0.2rem 0.4rem;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        @media (max-width: 480px) {
            .urgency-badge {
                font-size: 0.65rem;
                padding: 0.2rem 0.4rem;
                margin-left: 0.25rem;
            }
            
            .task-priority-container {
                flex-wrap: wrap;
            }
        }

        /* Task Progress Overview Styles */
        .task-progress-section {
            margin-bottom: 2rem;
        }

        .task-progress-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-lg);
        }

        .progress-header {
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .progress-header h3 {
            color: #fff;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .progress-header p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.95rem;
            margin: 0;
        }

        .task-progress-container {
            position: relative;
        }

        .task-progress-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .task-progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            transition: var(--transition);
            cursor: pointer;
            backdrop-filter: blur(10px);
        }

        .task-progress-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateX(4px);
        }

        .task-progress-item.completed {
            opacity: 0.8;
            border-left: 4px solid var(--success-gradient);
        }

        .task-info h4 {
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 0.5rem 0;
        }

        .task-meta {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .media-count-badge {
            background: var(--primary-gradient);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius-sm);
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow-sm);
        }

        /* Scrollbar styling for task progress list */
        .task-progress-list::-webkit-scrollbar {
            width: 6px;
        }

        .task-progress-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .task-progress-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .task-progress-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .task-progress-item {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .progress-header h3 {
                font-size: 1.1rem;
            }
        }
        /* Task Export Checkbox Styles */
        .task-export-checkbox {
            position: relative;
            margin-right: 0.5rem;
        }

        .task-export-checkbox input[type="checkbox"] {
            opacity: 0;
            position: absolute;
            width: 32px;
            height: 32px;
            cursor: pointer;
            z-index: 2;
            margin: 0;
        }

        .export-checkbox-custom {
            width: 32px;
            height: 32px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            font-size: 14px;
            color: transparent;
        }

        .export-checkbox-custom:hover {
            border-color: rgba(79, 172, 254, 0.6);
            background: rgba(79, 172, 254, 0.15);
            transform: scale(1.05);
        }

        .task-export-checkbox input[type="checkbox"]:checked + .export-checkbox-custom {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 12px rgba(67, 233, 123, 0.4);
        }

        .task-export-checkbox input[type="checkbox"]:checked + .export-checkbox-custom::after {
            content: 'ðŸ“¤';
            position: absolute;
            font-size: 16px;
            animation: exportPop 0.3s ease-out;
        }

        @keyframes exportPop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .task-export-checkbox input[type="checkbox"]:focus + .export-checkbox-custom {
            outline: 2px solid rgba(79, 172, 254, 0.5);
            outline-offset: 2px;
        }
        /* Light Mode */
        body.light-mode,
        body[data-theme="light"] {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%) !important;
            color: #2d3748 !important;
        }

        /* Light mode text colors */
        body.light-mode .welcome-title,
        body[data-theme="light"] .welcome-title {
            background: linear-gradient(45deg, #2d3748, #4a5568) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
            background-clip: text !important;
        }

        body.light-mode .welcome-subtitle,
        body[data-theme="light"] .welcome-subtitle {
            color: #4a5568 !important;
        }

        body.light-mode .section-title,
        body[data-theme="light"] .section-title {
            color: #2d3748 !important;
        }

        body.light-mode .task-title,
        body[data-theme="light"] .task-title {
            color: #2d3748 !important;
        }

        body.light-mode .stat-number,
        body[data-theme="light"] .stat-number {
            color: #2d3748 !important;
        }

        body.light-mode .stat-label,
        body[data-theme="light"] .stat-label {
            color: #4a5568 !important;
        }

        body.light-mode .current-date,
        body[data-theme="light"] .current-date {
            color: #2d3748 !important;
        }

        body.light-mode .current-time,
        body[data-theme="light"] .current-time {
            color: #4a5568 !important;
        }

        body.light-mode .due-date,
        body[data-theme="light"] .due-date {
            color: #4a5568 !important;
        }

        body.light-mode .sidebar-title,
        body[data-theme="light"] .sidebar-title {
            background: linear-gradient(45deg, #2d3748, #4a5568) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
            background-clip: text !important;
        }

        body.light-mode .nav-link,
        body[data-theme="light"] .nav-link {
            color: #4a5568 !important;
        }

        body.light-mode .nav-link:hover,
        body.light-mode .nav-link.active,
        body[data-theme="light"] .nav-link:hover,
        body[data-theme="light"] .nav-link.active {
            color: #2d3748 !important;
        }

        /* Light mode glass effects */
        body.light-mode .sidebar,
        body[data-theme="light"] .sidebar {
            background: rgba(255, 255, 255, 0.85) !important;
            backdrop-filter: blur(20px) !important;
            border-right: 1px solid rgba(0, 0, 0, 0.1) !important;
        }

        body.light-mode .dashboard-header,
        body.light-mode .task-form-card,
        body.light-mode .stat-card,
        body.light-mode .task-card,
        body[data-theme="light"] .dashboard-header,
        body[data-theme="light"] .task-form-card,
        body[data-theme="light"] .stat-card,
        body[data-theme="light"] .task-card {
            background: rgba(255, 255, 255, 0.85) !important;
            backdrop-filter: blur(20px) !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05) !important;
        }

        body.light-mode .main-content,
        body[data-theme="light"] .main-content {
            background: rgba(255, 255, 255, 0.1) !important;
        }

        /* Light mode form inputs */
        body.light-mode .form-input,
        body[data-theme="light"] .form-input {
            background: rgba(255, 255, 255, 0.9) !important;
            border: 1px solid rgba(0, 0, 0, 0.2) !important;
            color: #2d3748 !important;
        }

        body.light-mode .form-input::placeholder,
        body[data-theme="light"] .form-input::placeholder {
            color: #718096 !important;
        }

        body.light-mode .form-input:focus,
        body[data-theme="light"] .form-input:focus {
            border-color: rgba(0, 0, 0, 0.3) !important;
            background: rgba(255, 255, 255, 1) !important;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1) !important;
        }

        /* Light mode buttons */
        body.light-mode .task-btn,
        body[data-theme="light"] .task-btn {
            background: rgba(255, 255, 255, 0.8) !important;
            color: #4a5568 !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
        }

        body.light-mode .edit-btn:hover,
        body[data-theme="light"] .edit-btn:hover {
            background: rgba(59, 130, 246, 0.1) !important;
            color: #3b82f6 !important;
        }

        body.light-mode .delete-btn:hover,
        body[data-theme="light"] .delete-btn:hover {
            background: rgba(239, 68, 68, 0.1) !important;
            color: #ef4444 !important;
        }

        /* Light mode export checkbox */
        body.light-mode .export-checkbox-custom,
        body[data-theme="light"] .export-checkbox-custom {
            background: rgba(255, 255, 255, 0.9) !important;
            border: 2px solid rgba(0, 0, 0, 0.2) !important;
        }

        body.light-mode .export-checkbox-custom:hover,
        body[data-theme="light"] .export-checkbox-custom:hover {
            border-color: rgba(79, 172, 254, 0.6) !important;
            background: rgba(79, 172, 254, 0.1) !important;
        }

        /* Light mode task checkbox */
        body.light-mode .checkbox-custom,
        body[data-theme="light"] .checkbox-custom {
            background: rgba(255, 255, 255, 0.9) !important;
            border: 2px solid rgba(0, 0, 0, 0.2) !important;
        }

        body.light-mode .checkbox-custom:hover,
        body[data-theme="light"] .checkbox-custom:hover {
            border-color: rgba(0, 0, 0, 0.4) !important;
            background: rgba(255, 255, 255, 1) !important;
        }

        /* Light mode priority labels */
        body.light-mode .priority-label,
        body[data-theme="light"] .priority-label {
            color: #ffffff !important;
            border-color: rgba(0, 0, 0, 0.2) !important;
        }

        /* Light mode filter buttons */
        body.light-mode .filter-btn,
        body[data-theme="light"] .filter-btn {
            color: #4a5568 !important;
        }

        body.light-mode .filter-btn:hover,
        body.light-mode .filter-btn.active,
        body[data-theme="light"] .filter-btn:hover,
        body[data-theme="light"] .filter-btn.active {
            background: rgba(0, 0, 0, 0.1) !important;
            color: #2d3748 !important;
        }

        /* Light mode task filters container */
        body.light-mode .task-filters,
        body[data-theme="light"] .task-filters {
            background: rgba(255, 255, 255, 0.8) !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
        }
    </style>
</head>
<body class="dashboard-bg">
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobile-menu-btn" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar Overlay for mobile -->
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

    <!-- Sidebar with glassmorphism effect -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo-container">
                <div class="logo-icon" id="logo-icon" onclick="handleLogoClick()">
                    <i class="fas fa-calendar-check" id="logo-icon-content"></i>
                </div>
                <span class="sidebar-title">TaskFlow</span>
            </div>
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="fas fa-chevron-left" id="toggle-icon"></i>
            </button>
        </div>

        <ul class="sidebar-nav">
            <li><a href="/dashboard" onclick="showSection('dashboard')" class="nav-link active">
                <span class="nav-icon"><i class="fas fa-chart-line"></i></span>
                <span class="nav-text">Dashboard</span>
            </a></li>
            <li><a href="#" onclick="showSection('my-tasks')" class="nav-link">
                <span class="nav-icon"><i class="fas fa-user-check"></i></span>
                <span class="nav-text">My Tasks</span>
            </a></li>
            <li><a href="/completed-tasks" class="nav-link">
                <span class="nav-icon"><i class="fas fa-check-circle"></i></span>
                <span class="nav-text">Completed Tasks</span>
            </a></li>
            <li><a href="/gallery" class="nav-link">
                <span class="nav-icon"><i class="fas fa-images"></i></span>
                <span class="nav-text">Photo Gallery</span> 
            </a></li>
            <li><a href="/logout" onclick="showAbout()" class="nav-link logout">
                <span class="nav-icon"><i class="fas fa-sign-out-alt"></i></span>
                <span class="nav-text">Logout</span>
            </a></li>
        </ul>

    </div>

    <!-- Main content with enhanced design -->
    <div class="main-content" id="main-content">
        <!-- Dashboard header with notifications -->
        <div class="dashboard-header">
            <div class="welcome-section">
                <h1 class="welcome-title">Welcome back, {{username}}!</h1>
                <p class="welcome-subtitle">Here's what's happening with your tasks today</p>
            </div>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div class="date-display">
                    <div class="date-card">
                        <div class="current-date" id="current-date"></div>
                        <div class="current-time" id="current-time"></div>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="header-action-btn notification-bell" onclick="showNotifications()" title="Notifications">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
                    </button>
                    <button class="header-action-btn" onclick="showSettings()" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Error and Success Messages -->
        <div id="error-message" class="error-message"></div>
        <div id="success-message" class="success-message"></div>

        <!-- Dashboard statistics section -->
        <div id="dashboard-section">
            <div class="stats-grid">
                <div class="stat-card stat-primary">
                    <div class="stat-icon">
                        <i class="fas fa-clipboard-list"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="stat-total">0</div>
                        <div class="stat-label">Total Tasks</div>
                    </div>
                </div>
                <div class="stat-card stat-success">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="stat-completed">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                </div>
                <div class="stat-card stat-warning">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="stat-pending">0</div>
                        <div class="stat-label">Pending</div>
                    </div>
                </div>
                <div class="stat-card stat-info">
                    <div class="stat-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="stat-overdue">0</div>
                        <div class="stat-label">Overdue</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task Progress Overview Section -->
        <div class="task-progress-section">
            <div class="section-header">
                <h2 class="section-title">Task Progress Overview</h2>
                <div class="section-actions">
                    <button class="btn-secondary" onclick="toggleProgressView()">
                        <i class="fas fa-expand-alt"></i> Toggle View
                    </button>
                    <a href="/gallery" class="btn-primary" style="text-decoration: none;">
                        <i class="fas fa-images"></i> View Gallery
                    </a>
                </div>
            </div>
            
            <div class="task-progress-card">
                <div class="progress-header">
                    <h3><i class="fas fa-chart-pie"></i> Tasks with Media Attachments</h3>
                    <p>Track which tasks have visual documentation</p>
                </div>
                <div class="task-progress-container">
                    <div id="taskProgressList" class="task-progress-list"></div>
                </div>
            </div>
        </div>

        <!-- My tasks section with enhanced design -->
        <div id="my-tasks-section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">My Tasks</h2>
                <div class="task-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                     <button class="filter-btn" data-filter="due-soon">Due Soon</button>
                </div>
            </div>
            
            <div class="task-form-card">
                <div class="form-header">
                    <h3><i class="fas fa-plus-circle"></i> Add New Task</h3>
                </div>
                <form id="task-form" class="task-form">
                    <div class="form-group">
                        <input type="text" id="task-title" name="title" placeholder="Enter task title..." class="form-input" required>
                    </div>
                    <div class="form-group">
                        <input type="date" id="task-due-date" name="due_date" class="form-input">
                    </div>
                    <div class="form-group">
                        <select id="task-priority" name="priority" class="form-input">
                            <option value="" selected disabled>Select Category</option>
                            <option value="low" style="color: #4facfe; background-color: #ffff;">Low Priority</option>
                            <option value="medium" style="color: #43e97b; background-color: #ffff;">Medium Priority</option>
                            <option value="high" style="color: #fa709a; background-color: #ffff;">High Priority</option>
                        </select>
                    </div>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-plus"></i> Add Task
                    </button>
                </form>
            </div>

            <div class="tasks-container">
                
                <div id="loading-state" class="loading-state" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Loading tasks...</p>
                </div>
                <ul id="task-list" class="task-grid"></ul>
                <div id="empty-state" class="empty-state" style="display: none;">
                    <div class="empty-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <h3>No tasks yet</h3>
                    <p>Create your first task to get started!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Due Soon Indicator -->
    <div class="due-soon-indicator" id="due-soon-indicator" onclick="showDueSoonTasks()">
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-exclamation-triangle"></i>
            <div>
                <div style="font-weight: 600; font-size: 0.9rem;">Tasks Due Soon!</div>
                <div style="font-size: 0.8rem; opacity: 0.9;" id="due-soon-count">0 tasks need your attention</div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast-notification" id="toast-notification">
        <div class="toast-header">
            <div class="toast-title" id="toast-title">Notification</div>
            <button class="toast-close" onclick="hideToast()">Ã—</button>
        </div>
        <div class="toast-message" id="toast-message">Message content</div>
    </div>

    <script>

        let tasks = [];
        let currentFilter = 'all';
        let selectedTasks = new Set();


        // Initialize dashboard
        async function initializeDashboard() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // Load data from API instead of localStorage
            await loadTasks();
            await loadStats();
            
            initializeFilters();
            setupResponsiveHandlers();
            setupFormHandler();
            
            // Check for due soon tasks
            setTimeout(checkDueSoon, 2000);
        }
        // Update date and time display
        function updateDateTime() {
            const now = new Date();
            const dateOptions = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            const timeOptions = { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit'
            };
            
            document.getElementById('current-date').textContent = now.toLocaleDateString('en-US', dateOptions);
            document.getElementById('current-time').textContent = now.toLocaleTimeString('en-US', timeOptions);
        }

        // Load tasks 
        async function loadTasks() {
            try {
                const response = await fetch('/api/tasks');
                const result = await response.json();
                
                if (result.success) {
                    tasks = result.tasks;
                    renderTasks();
                } else {
                    showError('Failed to load tasks: ' + result.error);
                }
            } catch (error) {
                console.error('Error loading tasks:', error);
                showError('Failed to load tasks');
            }
                renderTaskProgress();
        }

        // Load statistics
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const result = await response.json();
                
                if (result.success) {
                    const stats = result.stats;
                    animateNumber('stat-total', stats.total_tasks);
                    animateNumber('stat-completed', stats.completed_tasks);
                    animateNumber('stat-pending', stats.pending_tasks);
                    animateNumber('stat-overdue', stats.overdue_tasks);
                } else {
                    showError('Failed to load statistics');
                }
            } catch (error) {
                console.error('Error loading stats:', error);
                showError('Failed to load statistics');
            }
        }

        // Animate number changes
        function animateNumber(elementId, target) {
            const element = document.getElementById(elementId);
            const current = parseInt(element.textContent) || 0;
            
            if (current === target) return;
            
            const increment = target > current ? 1 : -1;
            const duration = 1000;
            const steps = Math.abs(target - current);
            const stepTime = Math.max(duration / steps, 50);

            let currentValue = current;
            const timer = setInterval(() => {
                currentValue += increment;
                element.textContent = currentValue;
                if (currentValue === target) {
                    clearInterval(timer);
                }
            }, stepTime);
        }

        // Setup form handler
        function setupFormHandler() {
            const form = document.getElementById('task-form');
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                await addTask();
            });
        }

        // Add new task
        async function addTask() {
            const form = document.getElementById('task-form');
            const formData = new FormData(form);
            
            if (!formData.get('title').trim()) {
                showError('Please enter a task title');
                return;
            }

            if (!formData.get('priority')) {
                showError('Please select a priority level');
                return;
            }

            try {
                const response = await fetch('/api/tasks', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    form.reset();
                    await loadTasks();
                    await loadStats();

                    Swal.fire({
                        icon: 'success',
                        title: 'Task Added!',
                        text: 'Your task has been created successfully',
                        showConfirmButton: false,
                        timer: 1500,
                        timerProgressBar: true
                    });
                    
                    showToast('Task Created', `"${result.task.title}" has been added to your tasks`);
                } else {
                    showError(result.error);
                }
            } catch (error) {
                console.error('Error adding task:', error);
                showError('Failed to add task');
            }
        }
        // Edit task
        async function editTaskPrompt(id) {
            const task = tasks.find(t => String(t.id) === String(id));
            if (!task) return;

            const { value: formValues } = await Swal.fire({
                title: 'Edit Task',
                html: `
                    <input id="swal-input1" class="swal2-input" value="${task.title}" placeholder="Task title">
                    <input id="swal-input2" class="swal2-input" type="date" value="${task.due_date || ''}">
                    <select id="swal-input3" class="swal2-select">
                        <option value="low" ${task.priority === 'low' ? 'selected' : ''}>Low Priority</option>
                        <option value="medium" ${task.priority === 'medium' ? 'selected' : ''}>Medium Priority</option>
                        <option value="high" ${task.priority === 'high' ? 'selected' : ''}>High Priority</option>
                    </select>
                `,
                focusConfirm: false,
                showCancelButton: true,
                confirmButtonText: 'Update Task',
                showLoaderOnConfirm: true,
                preConfirm: () => {
                    const title = document.getElementById('swal-input1').value;
                    const due_date = document.getElementById('swal-input2').value;
                    const priority = document.getElementById('swal-input3').value;
                    
                    if (!title.trim()) {
                        Swal.showValidationMessage('Title cannot be empty');
                        return false;
                    }
                    
                    return { title, due_date, priority };
                },
                allowOutsideClick: () => !Swal.isLoading()
            });

            if (formValues) {
                await updateTask(id, formValues);
            }
        }

        // Update task
        async function updateTask(id, updateData) {
            try {
                const response = await fetch(`/api/tasks/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updateData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    await loadTasks();
                    await loadStats();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'Task Updated!',
                        text: 'Your task has been updated successfully',
                        showConfirmButton: false,
                        timer: 1500,
                        timerProgressBar: true
                    });
                } else {
                    showError(result.error);
                }
            } catch (error) {
                console.error('Error updating task:', error);
                showError('Failed to update task');
            }
        }

        // Delete task
        async function deleteTask(id) {
            const result = await Swal.fire({
                title: 'Delete Task?',
                text: "This action cannot be undone!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#ef4444',
                cancelButtonColor: '#6b7280',
                confirmButtonText: 'Yes, delete it!',
                showLoaderOnConfirm: true,
                preConfirm: async () => {
                    try {
                        const response = await fetch(`/api/tasks/${id}`, {
                            method: 'DELETE'
                        });
                        
                        const result = await response.json();
                        
                        if (!result.success) {
                            Swal.showValidationMessage(result.error);
                            return false;
                        }
                        
                        return true;
                    } catch (error) {
                        Swal.showValidationMessage('Failed to delete task');
                        return false;
                    }
                },
                allowOutsideClick: () => !Swal.isLoading()
            });

            if (result.isConfirmed) {
                await loadTasks();
                await loadStats();
                
                Swal.fire({
                    icon: 'success',
                    title: 'Task Deleted!',
                    text: 'Task has been permanently deleted',
                    showConfirmButton: false,
                    timer: 1500,
                    timerProgressBar: true
                });
            }
        }

        // Toggle task completion
        async function toggleComplete(id) {
            const task = tasks.find(t => String(t.id) === String(id));
            if (!task) return;

            try {
                Swal.fire({
                    title: task.completed ? 'Marking as Pending...' : 'Marking as Complete...',
                    html: '<div class="loading-spinner" style="margin: 0 auto;"></div>',
                    showConfirmButton: false,
                    allowOutsideClick: false,
                    timer: 800,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                const response = await fetch(`/api/tasks/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        completed: !task.completed
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    await loadTasks();
                    await loadStats();
                    
                    setTimeout(() => {
                        Swal.fire({
                            icon: 'success',
                            title: task.completed ? 'Marked as Pending!' : 'Marked as Complete!',
                            showConfirmButton: false,
                            timer: 1000,
                            timerProgressBar: true
                        });
                    }, 100);
                } else {
                    showError(result.error);
                }
            } catch (error) {
                console.error('Error toggling task:', error);
                showError('Failed to update task');
            }
        }

        // Enhanced task rendering
      
        function renderTasks() {
            const list = document.getElementById('task-list');
            const emptyState = document.getElementById('empty-state');
            
            let filteredTasks = tasks;
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);
            
            switch (currentFilter) {
                case 'completed':
                    filteredTasks = tasks.filter(t => t.completed);
                    break;
                case 'pending':
                    filteredTasks = tasks.filter(t => !t.completed);
                    break;
                case 'due-soon':
                    filteredTasks = tasks.filter(t => {
                        if (!t.due_date || t.completed) return false;
                        const dueDate = new Date(t.due_date);
                        const dueDateOnly = new Date(dueDate.getFullYear(), dueDate.getMonth(), dueDate.getDate());
                        // Include overdue tasks and tasks due today or tomorrow
                        return dueDateOnly.getTime() <= tomorrow.getTime();
                    });
                    break;
                default:
                    filteredTasks = tasks;
            }
            
            // Sort tasks based on current filter
            if (currentFilter === 'due-soon') {
                // For "Due Soon" filter: sort by urgency first, then priority
                filteredTasks.sort((a, b) => {
                    const now = new Date();
                    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    
                    const aDate = a.due_date ? new Date(a.due_date) : null;
                    const bDate = b.due_date ? new Date(b.due_date) : null;
                    
                    if (!aDate && !bDate) return 0;
                    if (!aDate) return 1;
                    if (!bDate) return -1;
                    
                    const aDueDateOnly = new Date(aDate.getFullYear(), aDate.getMonth(), aDate.getDate());
                    const bDueDateOnly = new Date(bDate.getFullYear(), bDate.getMonth(), bDate.getDate());
                    
                    // Calculate urgency scores
                    const getUrgencyScore = (dueDateOnly) => {
                        if (dueDateOnly.getTime() < today.getTime()) return 4; // Overdue
                        if (dueDateOnly.getTime() === today.getTime()) return 3; // Due today
                        if (dueDateOnly.getTime() === today.getTime() + 24*60*60*1000) return 2; // Due tomorrow
                        return 1; // Future dates
                    };
                    
                    const aUrgency = getUrgencyScore(aDueDateOnly);
                    const bUrgency = getUrgencyScore(bDueDateOnly);
                    
                    // First sort by urgency (overdue -> today -> tomorrow)
                    if (aUrgency !== bUrgency) {
                        return bUrgency - aUrgency;
                    }
                    
                    // Then by priority within same urgency level
                    const priorityOrder = { 'high': 3, 'medium': 2, 'low': 1 };
                    return (priorityOrder[b.priority] || 0) - (priorityOrder[a.priority] || 0);
                });
            } else {
                // For other filters: sort by completion status, then priority, then due date
                const priorityOrder = { 'high': 3, 'medium': 2, 'low': 1 };
                filteredTasks.sort((a, b) => {
                    // First sort by completion status (pending tasks first)
                    if (a.completed !== b.completed) {
                        return a.completed ? 1 : -1;
                    }
                    
                    // Then sort by priority (high to low)
                    const priorityDiff = (priorityOrder[b.priority] || 0) - (priorityOrder[a.priority] || 0);
                    if (priorityDiff !== 0) {
                        return priorityDiff;
                    }
                    
                    // Finally sort by due date (earliest first) for same priority
                    const aDate = a.due_date ? new Date(a.due_date) : null;
                    const bDate = b.due_date ? new Date(b.due_date) : null;
                    
                    if (!aDate && !bDate) return 0;
                    if (!aDate) return 1;
                    if (!bDate) return -1;
                    
                    return aDate.getTime() - bDate.getTime();
                });
            }
            
            if (filteredTasks.length === 0) {
                list.innerHTML = '';
                emptyState.style.display = 'block';
                
                // Update empty state message based on filter
                const emptyStateTitle = emptyState.querySelector('h3');
                const emptyStateText = emptyState.querySelector('p');
                
                if (currentFilter === 'due-soon') {
                    emptyStateTitle.textContent = 'No urgent tasks';
                    emptyStateText.textContent = 'Great! You have no overdue or upcoming tasks.';
                } else {
                    emptyStateTitle.textContent = 'No tasks yet';
                    emptyStateText.textContent = 'Create your first task to get started!';
                }
                return;
            }
            
            emptyState.style.display = 'none';
            list.innerHTML = '';
            
            filteredTasks.forEach((task, index) => {
                const li = document.createElement('li');
                li.className = 'task-card';
                li.style.animationDelay = `${index * 0.1}s`;
                li.setAttribute('data-task-id', task.id);
                
                const priorityClass = `priority-${task.priority}`;
                const isOverdue = !task.completed && task.due_date && new Date(task.due_date) < new Date();
                const isDueToday = task.due_date && new Date(task.due_date).toDateString() === new Date().toDateString();
                
                // Add urgency indicator for due soon filter
                let urgencyIndicator = '';
                if (currentFilter === 'due-soon' && task.due_date) {
                    const dueDate = new Date(task.due_date);
                    const dueDateOnly = new Date(dueDate.getFullYear(), dueDate.getMonth(), dueDate.getDate());
                    const today = new Date();
                    const todayOnly = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                    
                    if (dueDateOnly.getTime() < todayOnly.getTime()) {
                        urgencyIndicator = '<span class="urgency-badge overdue-urgent">OVERDUE</span>';
                    } else if (dueDateOnly.getTime() === todayOnly.getTime()) {
                        urgencyIndicator = '<span class="urgency-badge today-urgent">DUE TODAY</span>';
                    } else if (dueDateOnly.getTime() === todayOnly.getTime() + 24*60*60*1000) {
                        urgencyIndicator = '<span class="urgency-badge tomorrow-urgent">DUE TOMORROW</span>';
                    }
                }
                
                li.innerHTML = `
                    <div class="task-header">
                        <div class="task-priority-container">
                            <div class="task-priority ${priorityClass}"></div>
                            <span class="priority-label priority-${task.priority}">${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)} Priority</span>
                            ${urgencyIndicator}
                        </div>
                       <div class="task-actions">
                            <div class="task-export-checkbox">
                                <input type="checkbox" onchange="toggleTaskSelection(${task.id})" 
                                    id="export-task-${task.id}" title="Select for export">
                                <label for="export-task-${task.id}" class="export-checkbox-custom"></label>
                            </div>
                            <button onclick="editTaskPrompt('${task.id}')" class="task-btn edit-btn" title="Edit task">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteTask('${task.id}')" class="task-btn delete-btn" title="Delete task">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="task-content">
                        <div class="task-checkbox">
                            <input type="checkbox" ${task.completed ? 'checked' : ''} 
                                onchange="toggleComplete('${task.id}')" id="task-${task.id}">
                            <label for="task-${task.id}" class="checkbox-custom css-check"></label>
                        </div>
                        <div class="task-details">
                             <h4 class="task-title ${task.completed ? 'completed' : ''}">${task.title}</h4>
                            ${task.due_date ? `
                                <div class="task-meta">
                                    <div class="due-date ${isOverdue ? 'overdue' : ''} ${isDueToday ? 'due-today' : ''}">
                                        <i class="fas fa-calendar-alt"></i>
                                        Due: ${formatDate(task.due_date)}
                                        ${isOverdue ? '<span class="overdue-badge">Overdue</span>' : ''}
                                        ${isDueToday && !isOverdue ? '<span class="today-badge">Today</span>' : ''}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
                
                list.appendChild(li);
            });
            
            setTimeout(checkDueSoon, 500);
            renderTaskProgress();
        }

        // Initialize filter functionality
        function initializeFilters() {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    currentFilter = this.dataset.filter;
                    renderTasks();
                });
            });
        }

        // ShowSection function 

        function showSection(section) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            document.querySelector(`[onclick="showSection('${section}')"]`).classList.add('active');
            
            const sections = ['dashboard-section', 'my-tasks-section'];
            const taskProgressSection = document.querySelector('.task-progress-section');
            
            sections.forEach(sectionId => {
                const element = document.getElementById(sectionId);
                if (element) {
                    if (sectionId.includes(section)) {
                        element.style.display = '';
                        element.classList.add('fade-in');
                    } else {
                        element.style.display = 'none';
                        element.classList.remove('fade-in');
                    }
                }
            });
            
            // Hide/show task progress overview based on section
            if (taskProgressSection) {
                if (section === 'my-tasks') {
                    taskProgressSection.style.display = 'none';
                } else {
                    taskProgressSection.style.display = '';
                }
            }
            
            // Update URL hash
            if (section !== 'dashboard') {
                window.location.hash = section;
            } else {
                window.history.pushState("", document.title, window.location.pathname);
            }
        }

        // Enhanced sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const overlay = document.getElementById('sidebar-overlay');
            const toggleIcon = document.getElementById('toggle-icon');
            const logoIcon = document.getElementById('logo-icon-content');
            
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                const isOpen = sidebar.classList.toggle('mobile-open');
                overlay.classList.toggle('active', isOpen);
                
                const icon = mobileMenuBtn.querySelector('i');
                if (isOpen) {
                    icon.className = 'fas fa-times';
                } else {
                    icon.className = 'fas fa-bars';
                }
                
                document.body.style.overflow = isOpen ? 'hidden' : '';
            } else {
                const isCollapsed = sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded', isCollapsed);
                
                toggleIcon.className = isCollapsed ? 'fas fa-chevron-right' : 'fas fa-chevron-left';
                
                if (isCollapsed) {
                    logoIcon.className = 'fas fa-bars';
                } else {
                    logoIcon.className = 'fas fa-calendar-check';
                }
            }
        }

        // Handle logo icon click when collapsed
        function handleLogoClick() {
            const sidebar = document.getElementById('sidebar');
            const isMobile = window.innerWidth <= 768;
            
            if (!isMobile && sidebar.classList.contains('collapsed')) {
                toggleSidebar();
            }
        }

        // Close sidebar (for mobile)
        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.remove('mobile-open');
                overlay.classList.remove('active');
                
                const icon = mobileMenuBtn.querySelector('i');
                icon.className = 'fas fa-bars';
                
                document.body.style.overflow = '';
            }
        }

        // Setup responsive event handlers
        function setupResponsiveHandlers() {
            window.addEventListener('resize', handleResize);
            
            document.addEventListener('click', function(event) {
                const sidebar = document.getElementById('sidebar');
                const mobileMenuBtn = document.getElementById('mobile-menu-btn');
                const sidebarToggle = document.querySelector('.sidebar-toggle');
                
                if (window.innerWidth <= 768 && 
                    sidebar.classList.contains('mobile-open') &&
                    !sidebar.contains(event.target) &&
                    !mobileMenuBtn.contains(event.target) &&
                    !sidebarToggle.contains(event.target)) {
                    closeSidebar();
                }
            });
        }

        // Handle window resize
        function handleResize() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const overlay = document.getElementById('sidebar-overlay');
            const toggleIcon = document.getElementById('toggle-icon');
            const logoIcon = document.getElementById('logo-icon-content');
            
            if (window.innerWidth > 768) {
                sidebar.classList.remove('mobile-open');
                overlay.classList.remove('active');
                mobileMenuBtn.querySelector('i').className = 'fas fa-bars';
                document.body.style.overflow = '';
                
                const isCollapsed = sidebar.classList.contains('collapsed');
                toggleIcon.className = isCollapsed ? 'fas fa-chevron-right' : 'fas fa-chevron-left';
                logoIcon.className = isCollapsed ? 'fas fa-bars' : 'fas fa-calendar-check';
            } else {
                sidebar.classList.remove('collapsed');
                mainContent.classList.remove('expanded');
                logoIcon.className = 'fas fa-calendar-check';
            }
        }

        // Utility functions
        function formatDate(dateStr) {
            if (!dateStr) return '';
            const d = new Date(dateStr);
            return d.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }


        function checkDueSoon() {
            // Make sure tasks are loaded first
            if (!tasks || tasks.length === 0) {
                return;
            }
            
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const tomorrow = new Date(today.getTime() + 24*60*60*1000);
            
            const dueSoon = tasks.filter(t => {
                if (!t.due_date || t.completed) return false;
                const dueDate = new Date(t.due_date);
                const dueDateOnly = new Date(dueDate.getFullYear(), dueDate.getMonth(), dueDate.getDate());
                return dueDateOnly.getTime() === today.getTime() || dueDateOnly.getTime() === tomorrow.getTime();
            });
            
            const indicator = document.getElementById('due-soon-indicator');
            const countEl = document.getElementById('due-soon-count');
            const badge = document.getElementById('notification-badge');
            
            if (dueSoon.length > 0) {
                countEl.textContent = `${dueSoon.length} task${dueSoon.length !== 1 ? 's' : ''} need your attention`;
                indicator.classList.add('show');
                badge.textContent = dueSoon.length;
                badge.style.display = 'flex';
            } else {
                indicator.classList.remove('show');
                badge.style.display = 'none';
            }
            
            // Show notification only once per session for tasks due today
            if (!window.dueNotifShown && dueSoon.some(t => {
                const dueDate = new Date(t.due_date);
                const dueDateOnly = new Date(dueDate.getFullYear(), dueDate.getMonth(), dueDate.getDate());
                return dueDateOnly.getTime() === today.getTime();
            })) {
                const todayTasks = dueSoon.filter(t => {
                    const dueDate = new Date(t.due_date);
                    const dueDateOnly = new Date(dueDate.getFullYear(), dueDate.getMonth(), dueDate.getDate());
                    return dueDateOnly.getTime() === today.getTime();
                });
                
                if (todayTasks.length > 0) {
                    setTimeout(() => {
                        Swal.fire({
                            icon: 'warning',
                            title: 'â° Tasks Due Today!',
                            html: `
                                <div style="margin: 1rem 0;">
                                    <div style="height: 4px; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 2px; margin: 1rem 0; animation: progress-loading 2s ease-in-out infinite;"></div>
                                </div>
                                ${todayTasks.map(t => 
                                    `<div style="background: rgba(243, 223, 92, 0.96); margin: 0.5rem 0; padding: 1rem; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                        <strong>${t.title}</strong><br>
                                        <small>Priority: ${t.priority.charAt(0).toUpperCase() + t.priority.slice(1)}</small>
                                    </div>`
                                ).join('')}
                            `,
                            showConfirmButton: true,
                            confirmButtonText: 'Got it!',
                            timer: 10000,
                            timerProgressBar: true
                        });
                    }, 3000);
                    window.dueNotifShown = true;
                }
            }
        }

        function showDueSoonTasks() {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);
            
            const dueSoon = tasks.filter(task => {
                if (task.completed || !task.due_date) return false;
                const dueDate = new Date(task.due_date);
                const dueDateOnly = new Date(dueDate.getFullYear(), dueDate.getMonth(), dueDate.getDate());
                return dueDateOnly.getTime() >= today.getTime() && dueDateOnly.getTime() <= tomorrow.getTime();
            });
            
            if (dueSoon.length === 0) {
                Swal.fire({
                    icon: 'info',
                    title: 'No Tasks Due Soon',
                    text: 'You\'re all caught up! No tasks are due in the next day.',
                    confirmButtonText: 'Great!'
                });
                return;
            }
            
            const taskList = dueSoon.map(task => {
                const dueDate = new Date(task.due_date);
                const dueDateOnly = new Date(dueDate.getFullYear(), dueDate.getMonth(), dueDate.getDate());
                const isToday = dueDateOnly.getTime() === today.getTime();
                const priorityColor = task.priority === 'high' ? '#91f4b7ff' : task.priority === 'medium' ? '#43e97bff' : '#4facfe';
                
                return `
                    <div style="background: #75f09eff; margin: 0.5rem 0; padding: 1rem; border-radius: 8px; border-left: 4px solid ${priorityColor};">
                        <strong>${task.title}</strong><br>
                        <small>Due: ${isToday ? 'Today' : 'Tomorrow'} â€¢ Priority: ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}</small>
                    </div>
                `;
            }).join('');
            
            Swal.fire({
                icon: 'warning',
                title: 'â° Tasks Due Soon',
                html: `
                    <div style="margin: 1rem 0;">
                        <p>You have ${dueSoon.length} task${dueSoon.length !== 1 ? 's' : ''} due soon:</p>
                        ${taskList}
                    </div>
                `,
                showConfirmButton: true,
                confirmButtonText: 'Got it!',
                showCancelButton: true,
                cancelButtonText: 'View Tasks',
                timer: 15000,
                timerProgressBar: true
            }).then((result) => {
                if (result.dismiss === Swal.DismissReason.cancel) {
                    showSection('my-tasks');
                }
            });
        }

        // Show/hide error and success messages
        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('success-message');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 3000);
        }

        // Toast notification functions
        function showToast(title, message, type = 'info') {
            const toast = document.getElementById('toast-notification');
            const titleEl = document.getElementById('toast-title');
            const messageEl = document.getElementById('toast-message');
            
            titleEl.textContent = title;
            messageEl.textContent = message;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                hideToast();
            }, 5000);
        }

        function hideToast() {
            const toast = document.getElementById('toast-notification');
            toast.classList.remove('show');
        }

        // Mock notification and settings functions
        function showNotifications() {
            Swal.fire({
                icon: 'info',
                title: 'Notifications',
                html: `
                    <div style="text-align: left;">
                        <div style="background: rgba(59, 130, 246, 0.1); border-left: 4px solid #3b82f6; padding: 1rem; margin: 0.5rem 0; border-radius: 8px;">
                            <strong>Welcome to TaskFlow!</strong><br>
                            <small>Your task management dashboard is ready to use.</small>
                        </div>
                        ${tasks.filter(t => !t.completed && t.due_date).slice(0, 3).map(t => `
                            <div style="background: rgba(245, 158, 11, 0.1); border-left: 4px solid #f59e0b; padding: 1rem; margin: 0.5rem 0; border-radius: 8px;">
                                <strong>Task Reminder</strong><br>
                                <small>"${t.title}" - Due: ${formatDate(t.due_date)}</small>
                            </div>
                        `).join('')}
                    </div>
                `,
                confirmButtonText: 'Close',
                width: '500px'
            });
        }

        function showSettings() {
            // Load current settings from localStorage
            const currentSettings = JSON.parse(localStorage.getItem('taskflow_settings') || '{}');
            const defaultSettings = {
                notifications: true,
                dueDateReminders: true,
                soundNotifications: true,
                autoRefresh: true,
                theme: 'default'
            };
            
            const settings = { ...defaultSettings, ...currentSettings };
            
            Swal.fire({
                title: '',
                html: `
                    <div class="modern-settings-container">
                        <!-- Header Section -->
                        <div class="settings-header">
                            <div class="settings-icon">
                                <i class="fas fa-cog"></i>
                            </div>
                            <h2 class="settings-title">Dashboard Settings</h2>
                            <p class="settings-subtitle">Customize your TaskFlow experience</p>
                        </div>

                        <!-- Settings Sections -->
                        <div class="settings-content">
                            <!-- Notifications Section -->
                            <div class="settings-section">
                                <div class="section-header">
                                    <div class="section-icon">
                                        <i class="fas fa-bell"></i>
                                    </div>
                                    <div class="section-info">
                                        <h4>Notifications</h4>
                                        <p>Manage your notification preferences</p>
                                    </div>
                                </div>
                                
                                <div class="settings-grid">
                                    <div class="setting-item">
                                        <div class="setting-details">
                                            <span class="setting-label">Task Notifications</span>
                                            <span class="setting-description">Get notified about task updates</span>
                                        </div>
                                        <label class="modern-toggle">
                                            <input type="checkbox" id="setting-notifications" ${settings.notifications ? 'checked' : ''}>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    
                                    <div class="setting-item">
                                        <div class="setting-details">
                                            <span class="setting-label">Due Date Reminders</span>
                                            <span class="setting-description">Show alerts for upcoming deadlines</span>
                                        </div>
                                        <label class="modern-toggle">
                                            <input type="checkbox" id="setting-reminders" ${settings.dueDateReminders ? 'checked' : ''}>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    
                                    <div class="setting-item">
                                        <div class="setting-details">
                                            <span class="setting-label">Sound Notifications</span>
                                            <span class="setting-description">Play sounds for important alerts</span>
                                        </div>
                                        <label class="modern-toggle">
                                            <input type="checkbox" id="setting-sound" ${settings.soundNotifications ? 'checked' : ''}>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- General Section -->
                            <div class="settings-section">
                                <div class="section-header">
                                    <div class="section-icon">
                                        <i class="fas fa-sliders-h"></i>
                                    </div>
                                    <div class="section-info">
                                        <h4>General Settings</h4>
                                        <p>Configure general preferences</p>
                                    </div>
                                </div>
                                
                                <div class="settings-grid">
                                    <div class="setting-item">
                                        <div class="setting-details">
                                            <span class="setting-label">Auto-Refresh Dashboard</span>
                                            <span class="setting-description">Automatically update task data</span>
                                        </div>
                                        <label class="modern-toggle">
                                            <input type="checkbox" id="setting-refresh" ${settings.autoRefresh ? 'checked' : ''}>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Theme Section -->
                            <div class="settings-section">
                                <div class="section-header">
                                    <div class="section-icon">
                                        <i class="fas fa-palette"></i>
                                    </div>
                                    <div class="section-info">
                                        <h4>Appearance</h4>
                                        <p>Choose your preferred theme</p>
                                    </div>
                                </div>
                                
                                <div class="theme-selector">
                                    <div class="theme-options">
                                        <label class="theme-option ${settings.theme === 'default' ? 'active' : ''}" data-theme="default">
                                            <input type="radio" name="theme" value="default" id="theme-default" ${settings.theme === 'default' ? 'checked' : ''}>
                                            <div class="theme-preview default-theme">
                                                <div class="theme-colors">
                                                    <div class="color-1"></div>
                                                    <div class="color-2"></div>
                                                    <div class="color-3"></div>
                                                </div>
                                            </div>
                                            <span class="theme-name">Default Gradient</span>
                                        </label>
                                        
                                        <label class="theme-option ${settings.theme === 'dark' ? 'active' : ''}" data-theme="dark">
                                            <input type="radio" name="theme" value="dark" id="theme-dark" ${settings.theme === 'dark' ? 'checked' : ''}>
                                            <div class="theme-preview dark-theme">
                                                <div class="theme-colors">
                                                    <div class="color-1"></div>
                                                    <div class="color-2"></div>
                                                    <div class="color-3"></div>
                                                </div>
                                            </div>
                                            <span class="theme-name">Dark Mode</span>
                                        </label>
                                        
                                        <label class="theme-option ${settings.theme === 'light' ? 'active' : ''}" data-theme="light">
                                            <input type="radio" name="theme" value="light" id="theme-light" ${settings.theme === 'light' ? 'checked' : ''}>
                                            <div class="theme-preview light-theme">
                                                <div class="theme-colors">
                                                    <div class="color-1"></div>
                                                    <div class="color-2"></div>
                                                    <div class="color-3"></div>
                                                </div>
                                            </div>
                                            <span class="theme-name">Light Mode</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Footer -->
                        <div class="settings-footer">
                            <div class="footer-info">
                                <i class="fas fa-info-circle"></i>
                                <span>Settings are automatically saved and will persist across sessions</span>
                            </div>
                        </div>
                    </div>
                `,
                showConfirmButton: true,
                showCancelButton: true,
                confirmButtonText: '<i class="fas fa-save"></i> Save Settings',
                cancelButtonText: '<i class="fas fa-times"></i> Cancel',
                customClass: {
                    popup: 'modern-settings-popup',
                    confirmButton: 'modern-confirm-btn',
                    cancelButton: 'modern-cancel-btn'
                },
                width: '700px',
                showLoaderOnConfirm: true,
                didOpen: () => {
                    // Add event listeners for theme selection
                    document.querySelectorAll('.theme-option').forEach(option => {
                        option.addEventListener('click', function() {
                            document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
                            this.classList.add('active');
                            this.querySelector('input').checked = true;
                        });
                    });
                },
                preConfirm: () => {
                    const newSettings = {
                        notifications: document.getElementById('setting-notifications').checked,
                        dueDateReminders: document.getElementById('setting-reminders').checked,
                        soundNotifications: document.getElementById('setting-sound').checked,
                        autoRefresh: document.getElementById('setting-refresh').checked,
                        theme: document.querySelector('input[name="theme"]:checked').value
                    };
                    
                    // Save settings to localStorage
                    localStorage.setItem('taskflow_settings', JSON.stringify(newSettings));
                    
                    // Apply settings immediately
                    applySettings(newSettings);
                    
                    return newSettings;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    showToast('Settings Saved', 'Your preferences have been updated and applied');
                }
            });
        }



        function applySettings(settings) {
            // Remove existing theme classes
            document.body.classList.remove('light-mode');
            document.body.removeAttribute('data-theme');
            
            // Apply theme
            if (settings.theme === 'dark') {
                document.body.style.background = 'linear-gradient(135deg, #2d3748 0%, #1a202c 100%)';
                document.body.setAttribute('data-theme', 'dark');
            } else if (settings.theme === 'light') {
                document.body.style.background = 'linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%)';
                document.body.classList.add('light-mode');
                document.body.setAttribute('data-theme', 'light');
            } else {
                document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                document.body.setAttribute('data-theme', 'default');
            }
            
            // Store settings globally for other functions to use
            window.taskflowSettings = settings;
            
            // Update notification behavior based on settings
            if (!settings.notifications) {
                const badge = document.getElementById('notification-badge');
                if (badge) badge.style.display = 'none';
            }
            
            // Update due date reminder behavior
            if (!settings.dueDateReminders) {
                const dueSoonIndicator = document.getElementById('due-soon-indicator');
                if (dueSoonIndicator) dueSoonIndicator.style.display = 'none';
            }
        }

        // Add this function to load and apply settings on page load (add this to your initializeDashboard function)
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('taskflow_settings') || '{}');
            const defaultSettings = {
                notifications: true,
                dueDateReminders: true,
                soundNotifications: true,
                autoRefresh: true,
                theme: 'default'
            };
            
            const finalSettings = { ...defaultSettings, ...settings };
            applySettings(finalSettings);
        }

        function showAbout() {
            Swal.fire({
                icon: 'info',
                title: 'About TaskFlow',
                html: `
                    <div style="text-align: left; padding: 1rem;">
                        <p style="margin-bottom: 1rem; color: rgba(255,255,255,0.9);">
                            TaskFlow is a modern, responsive task management dashboard built with HTML, CSS, and JavaScript.
                        </p>
                        <h4 style="color: #667eea; margin: 1rem 0 0.5rem 0;">Features:</h4>
                        <ul style="text-align: left; color: rgba(255,255,255,0.8); line-height: 1.6;">
                            <li>Beautiful glassmorphism design</li>
                            <li>Responsive layout for all devices</li>
                            <li>Task priority management</li>
                            <li>Due date tracking</li>
                            <li>Real-time statistics</li>
                            <li>Smooth animations</li>
                        </ul>
                        <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.2);">
                            <small style="color: rgba(255,255,255,0.7);">Demo version - Data is stored locally in your browser.</small>
                        </div>
                    </div>
                `,
                confirmButtonText: 'Got it!',
                width: '500px'
            });
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', async function() {
            // Check for URL hash and show appropriate section
            const hash = window.location.hash.substring(1);
            if (hash && hash === 'my-tasks') {
                showSection('my-tasks');
            } else {
                showSection('dashboard');
            }
            
            // Initialize dashboard with API data
            await initializeDashboard();
            handleResize();
            
            // Remove these localStorage-related lines:
            // if (tasks.length === 0) {
            //     renderTasks();
            //     loadStats();
            // }
            
            initializeFilters();
            setupResponsiveHandlers();
            checkDueSoon();
            loadSettings();
        });

        // Handle keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // Ctrl/Cmd + N to add new task
            if ((event.ctrlKey || event.metaKey) && event.key === 'n') {
                event.preventDefault();
                showSection('my-tasks');
                setTimeout(() => {
                    document.getElementById('task-title').focus();
                }, 100);
            }
            
            // Ctrl/Cmd + B to toggle notifications
            if ((event.ctrlKey || event.metaKey) && event.key === 'b') {
                event.preventDefault();
                showNotifications();
            }
            
            // Escape to close mobile sidebar
            if (event.key === 'Escape' && window.innerWidth <= 768) {
                closeSidebar();
            }
        });

        //added script
        async function testAPIConnection() {
            try {
                console.log('Testing API connection...');
                
                // Test tasks endpoint
                const tasksResponse = await fetch('/api/tasks');
                const tasksResult = await tasksResponse.json();
                console.log('Tasks API response:', tasksResult);
                
                // Test stats endpoint
                const statsResponse = await fetch('/api/stats');
                const statsResult = await statsResponse.json();
                console.log('Stats API response:', statsResult);
                
                if (tasksResult.success && statsResult.success) {
                    console.log('âœ… API connection successful!');
                    showToast('Connection Test', 'API connection successful!', 'success');
                } else {
                    console.log('âŒ API returned errors');
                    showError('API connection failed');
                }
            } catch (error) {
                console.error('âŒ API connection failed:', error);
                showError('Cannot connect to server');
            }
        }
        // Task Progress Overview Functions
    function renderTaskProgress() {
        const progressList = document.getElementById('taskProgressList');
        if (!progressList) return;
        
        progressList.innerHTML = '';

        if (tasks.length === 0) {
            progressList.innerHTML = `
                <div style="text-align: center; padding: 2rem; opacity: 0.7;">
                    <i class="fas fa-tasks" style="font-size: 2rem; margin-bottom: 1rem; color: rgba(255, 255, 255, 0.6);"></i>
                    <p style="color: rgba(255, 255, 255, 0.8);">No tasks found. Create some tasks first!</p>
                </div>
            `;
            return;
        }

    // Get media files from localStorage or initialize empty array
            const mediaFiles = JSON.parse(localStorage.getItem('taskflow_media') || '[]');

            tasks.forEach(task => {
                const taskMedia = mediaFiles.filter(m => m.task_id === task.id);
                const progressItem = document.createElement('div');
                progressItem.className = `task-progress-item ${task.completed ? 'completed' : ''}`;
                
                progressItem.innerHTML = `
                    <div class="task-info">
                        <h4>${task.completed ? 'âœ…' : 'ðŸ“‹'} ${task.title}</h4>
                        <div class="task-meta">
                            Due: ${formatDate(task.due_date)} â€¢ 
                            Status: ${task.completed ? 'Completed' : 'In Progress'}
                        </div>
                    </div>
                    <div class="media-count-badge">
                        <i class="fas fa-images"></i> ${taskMedia.length} files
                    </div>
                `;
                
                progressItem.addEventListener('click', () => {
                    viewTaskMediaInGallery(task.id);
                });
                
                progressList.appendChild(progressItem);
            });
        }

        function toggleProgressView() {
            const progressList = document.getElementById('taskProgressList');
            if (!progressList) return;
            
            const isExpanded = progressList.style.maxHeight !== '300px';
            
            if (isExpanded) {
                progressList.style.maxHeight = '300px';
                progressList.style.overflowY = 'auto';
            } else {
                progressList.style.maxHeight = 'none';
                progressList.style.overflowY = 'visible';
            }
        }

        function viewTaskMediaInGallery(taskId) {
            // Store the task filter for the gallery page
            sessionStorage.setItem('gallery_filter_task_id', taskId);
            sessionStorage.setItem('gallery_filter_type', 'task-specific');
            
            // Navigate to gallery with task filter
            window.location.href = `/gallery?task_id=${taskId}&filter=task`;
        }

        function formatDate(dateStr) {
            if (!dateStr) return 'No due date';
            const d = new Date(dateStr);
            return d.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        // Task Selection and Export Functions
        function toggleTaskSelection(taskId) {
            if (selectedTasks.has(taskId)) {
                selectedTasks.delete(taskId);
            } else {
                selectedTasks.add(taskId);
            }
            updateBulkActionsVisibility();
        }

            function updateBulkActionsVisibility() {
                if (selectedTasks.size > 0) {
                    // Show export button as floating action button
                    showFloatingExportButton();
                } else {
                    hideFloatingExportButton();
                }
            }

            function showFloatingExportButton() {
                let floatingBtn = document.getElementById('floating-export-btn');
                if (!floatingBtn) {
                    floatingBtn = document.createElement('div');
                    floatingBtn.id = 'floating-export-btn';
                    floatingBtn.innerHTML = `
                        <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); 
                                    color: white; padding: 1rem 1.5rem; border-radius: 50px; 
                                    box-shadow: 0 8px 25px rgba(67, 233, 123, 0.4); 
                                    cursor: pointer; transition: all 0.3s ease;
                                    position: fixed; bottom: 2rem; right: 17rem; z-index: 1000;
                                    display: flex; align-items: center; gap: 0.5rem;
                                    backdrop-filter: blur(10px);"
                            onclick="exportSelectedTasks()"
                            onmouseover="this.style.transform='translateY(-2px) scale(1.05)'"
                            onmouseout="this.style.transform='translateY(0) scale(1)'">
                            <i class="fas fa-download"></i>
                            <span>Export ${selectedTasks.size} task${selectedTasks.size === 1 ? '' : 's'}</span>
                            <button onclick="event.stopPropagation(); clearTaskSelection()" 
                                    style="background: rgba(255,255,255,0.2); border: none; 
                                        border-radius: 50%; width: 24px; height: 24px; 
                                        color: white; cursor: pointer; margin-left: 0.5rem;
                                        display: flex; align-items: center; justify-content: center;">
                                Ã—
                            </button>
                        </div>
                    `;
                    document.body.appendChild(floatingBtn);
                } else {
                    floatingBtn.querySelector('span').textContent = `Export ${selectedTasks.size} task${selectedTasks.size === 1 ? '' : 's'}`;
                    floatingBtn.style.display = 'block';
                }
            }

            function hideFloatingExportButton() {
                const floatingBtn = document.getElementById('floating-export-btn');
                if (floatingBtn) {
                    floatingBtn.style.display = 'none';
                }
            }

        function clearTaskSelection() {
            selectedTasks.clear();
                document.querySelectorAll('.task-export-checkbox input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
            updateBulkActionsVisibility();
        }

        async function exportSelectedTasks() {
            if (selectedTasks.size === 0) {
                showError('Please select tasks to export');
                return;
            }

            try {
                const response = await fetch('/api/export-tasks', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        task_ids: Array.from(selectedTasks)
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    // Create and download the text file
                    const blob = new Blob([result.report], { 
                        type: 'text/plain;charset=utf-8' 
                    });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = result.filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);

                    showSuccess(`Successfully exported ${selectedTasks.size} task${selectedTasks.size === 1 ? '' : 's'}!`);
                    clearTaskSelection();
                } else {
                    showError('Export failed: ' + result.error);
                }
            } catch (error) {
                console.error('Export failed:', error);
                showError('Export failed: ' + error.message);
            }
        }

        // Keyboard shortcuts for task selection
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + A to select all visible tasks
            if ((e.ctrlKey || e.metaKey) && e.key === 'a' && !e.target.matches('input, textarea, select')) {
                e.preventDefault();
                selectAllVisibleTasks();
            }
            
            // Escape to clear selection
            if (e.key === 'Escape') {
                clearTaskSelection();
            }
        });

        function selectAllVisibleTasks() {
            const visibleCheckboxes = document.querySelectorAll('.task-export-checkbox input[type="checkbox"]');
                visibleCheckboxes.forEach(checkbox => {
                    const taskId = parseInt(checkbox.id.replace('export-task-', ''));
                    selectedTasks.add(taskId);
                    checkbox.checked = true;
                });
            updateBulkActionsVisibility();
        }
    </script>
</body>
</html>